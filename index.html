<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุขูุฉ ุญุงุณุจุฉ ุงูุฃุตูุงู</title>
    
    <!-- === ุงูุณุทุฑุงู ุงูุฌุฏูุฏุงู ูุฌุนูู ุชุทุจูู ููุจ === -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#005A9C">
    <!-- ======================================= -->

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #005A9C;
            --primary-hover: #003D6B;
            --secondary-color: #f0f2f5; 
            --accent-green: #28a745;
            --accent-green-hover: #218838;
            --accent-red: #dc3545;
            --accent-red-hover: #c82333;
            --text-color: #333;
            --border-color: #dee2e6;
            --card-bg: #ffffff;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --border-radius: 12px;
        }

        body {
            font-family: 'Cairo', sans-serif;
            margin: 0;
            padding: 20px;
            direction: rtl;
            background-color: var(--secondary-color);
            color: var(--text-color);
            line-height: 1.7;
        }

        h1 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 20px;
        }

        .search-container {
            display: none;
            margin-bottom: 20px;
        }

        #search-input-mobile {
            width: 100%;
            padding: 12px 20px;
            font-size: 1rem;
            border-radius: 25px;
            border: 1px solid var(--border-color);
            box-sizing: border-box;
        }
        
        #calculators-container {
            padding-bottom: 100px;
        }

        .calculator-container {
            border: 1px solid var(--border-color);
            padding: 20px;
            margin-bottom: 25px;
            border-radius: var(--border-radius);
            background-color: var(--card-bg);
            box-shadow: var(--shadow);
            transition: box-shadow 0.3s ease;
        }
        
        .calculator-container:hover {
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }

        .calculator-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            margin-bottom: 15px;
        }
        
        .calculator-title-display {
             display: flex;
             align-items: center;
             gap: 10px;
        }

        .calculator-title {
            font-weight: 700;
            color: var(--primary-color);
            font-size: 1.3rem;
        }
        
        .calculator-date {
            font-size: 0.8rem;
            color: #6c757d;
        }
        
        .edit-title-btn {
            background: none; border: none; color: var(--primary-color);
            cursor: pointer; font-size: 1rem;
        }
        .edit-title-btn:hover { color: var(--primary-hover); }

        .calculator-title-input {
            width: 100%; padding: 10px; margin-bottom: 10px;
            box-sizing: border-box; border: 1px solid #ccc;
            border-radius: var(--border-radius); font-family: 'Cairo', sans-serif;
            font-size: 1.1rem;
        }

        .item {
            display: grid;
            grid-template-columns: 1fr 1fr 80px 80px 60px; 
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px;
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: var(--border-radius);
        }

        select, input[type="number"] {
            padding: 10px;
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            font-family: 'Cairo', sans-serif;
            font-size: 0.9rem;
            width: 100%;
            box-sizing: border-box;
        }

        button {
            padding: 10px; border-radius: var(--border-radius);
            cursor: pointer; color: white; border: none;
            font-family: 'Cairo', sans-serif; font-weight: 600;
            transition: all 0.2s ease;
        }
        button:hover { opacity: 0.85; }

        .item button { background-color: var(--accent-red); }

        .totals-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        .total, .shipping, .grand-total {
            display: flex; justify-content: space-between; align-items: center;
            margin-top: 10px; font-size: 1.1rem; font-weight: 600;
        }
        .grand-total {
            font-size: 1.4rem; color: var(--primary-color);
            border-top: 2px dashed var(--border-color);
            padding-top: 15px; margin-top: 15px;
        }
        
        .price, .shipping-cost, .grand-total-value { font-weight: 700; }

        .results-text-container {
            margin-top: 20px; padding: 15px;
            border: 1px solid var(--primary-color);
            background-color: #e8f0fe;
            border-radius: var(--border-radius);
            white-space: pre-wrap;
            font-family: 'Menlo', 'Consolas', monospace;
            text-align: right; line-height: 1.8;
            font-size: 1rem; font-weight: bold;
            -webkit-user-select: text; user-select: text;
        }
        .copy-actions { margin-top: 10px; display: flex; gap: 10px; }
        .copy-actions button { flex-grow: 1; }
        .copy-instruction { font-size: 0.9rem; color: #555; text-align: center; margin-top: 8px; }

        .fixed-controls {
            position: fixed; bottom: 15px; left: 50%;
            transform: translateX(-50%); display: flex;
            align-items: center; justify-content: center; gap: 10px;
            z-index: 1000; background-color: var(--card-bg);
            padding: 12px 20px; border-radius: 50px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15); width: auto;
            max-width: 95%;
        }

        #search-input-desktop {
            width: 250px; border-radius: 20px;
            padding: 10px 15px; border: 1px solid var(--border-color);
        }
        .new-calculator-btn { background-color: var(--accent-green); }
        .json-btn { background-color: var(--primary-color); }

        #json-file-input { display: none; }
        .import-json-label {
            padding: 10px 20px; background-color: var(--primary-color);
            color: white; border-radius: var(--border-radius); cursor: pointer;
            font-weight: 600;
        }
        .calculator-counter {
            background-color: #e9ecef; color: #495057;
            padding: 10px 15px; border-radius: 20px; font-weight: 600;
        }
        
        @media (max-width: 768px) {
            body { padding: 10px 10px 100px 10px; }
            h1 { font-size: 1.5rem; }
            
            .search-container { display: block; }

            .item {
                grid-template-columns: 1fr;
                gap: 12px;
                padding: 15px;
            }

            select, input[type="number"], button {
                font-size: 1rem;
                padding: 12px;
            }
            .item-controls { display: flex; gap: 10px; align-items: center; }
            .item-controls input[type="number"] { width: 70px; flex-shrink: 0; }
            .item-controls .price { flex-grow: 1; text-align: center; }
            .item-controls button { font-size: 0.9rem; padding: 10px; }

            .fixed-controls {
                flex-direction: row; justify-content: space-around;
                width: 100%; max-width: 100%;
                bottom: 0; left: 0; right: 0;
                border-radius: 0;
                padding: 10px 5px;
                border-top: 1px solid var(--border-color);
                box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            }
            #search-input-desktop, .calculator-counter { display: none; }
            .fixed-controls button, .fixed-controls .import-json-label {
                padding: 10px; font-size: 0.8rem;
                display: flex; flex-direction: column; align-items: center;
                gap: 2px;
                background: none; color: var(--primary-color);
            }
            .fixed-controls .new-calculator-btn { color: var(--accent-green); }
        }
    </style>
</head>
<body>
    <h1>ุขูุฉ ุญุงุณุจุฉ ุงูุฃุตูุงู</h1>
    <div class="search-container">
        <input type="text" id="search-input-mobile" placeholder="ุงุจุญุซ ูู ุนูุงููู ุงูุขูุงุช ุงูุญุงุณุจุฉ..." onkeyup="searchCalculators(this.value)">
    </div>
    <div id="calculators-container"></div>
    <div class="fixed-controls">
        <input type="text" id="search-input-desktop" placeholder="ุงุจุญุซ..." onkeyup="searchCalculators(this.value)">
        <button class="new-calculator-btn" onclick="addNewCalculator()"><span>โ</span><span>ุฌุฏูุฏุฉ</span></button>
        <button class="json-btn" onclick="exportCalculatorsAsJSON()"><span>๐พ</span><span>ุญูุธ</span></button>
        <label for="json-file-input" class="import-json-label"><span>๐</span><span>ุชุญููู</span></label>
        <input type="file" id="json-file-input" accept=".json" onchange="importCalculatorsFromJSON(event)">
        <div class="calculator-counter" id="calculator-counter"></div>
    </div>

    <script>
        // ุงูุฃุตูุงู ูุงูุฃุณุนุงุฑ ูุงููุฆุงุช
        const prices = {
            "1- ูููู ุนุณู ููุงุฑู ุงูุจุฑุณูู  ุตุงูู ": 180,"2- ูููู ุนุณู  ุจุฑุณูู ุจูุฏู   ": 140,
            "3- ูููู ุนุณู ุจุฑุณูู ุตุญุฑุงูู ": 230,"4- ูููู ุนุณู ุฒููุฑ ุงูููุงูุญ": 230,"5- ูููู ุนุณู ุฒููุฑ ุงูุดูุฑ ุงูุฌุจูู": 250,
            "6- ูููู ุนุณู ุงูุงุซู  ": 250,"7- ูููู ุนุณู ุฒููุฑ ุญุจู ุงูุจุฑูู":220,"8- ูููู ุนุณู ุฒููุฑ ุงูุฒุนุชุฑ ุงูุทุจูู ุงูุฌุจูู ุงูุงูุฑุฌุงูู":250,
            "9- ูููู ุนุณู ุฒููุฑ ุงูุจุฑุฏููุด ุงูุทุจูุนู ุตุงูู ููุงุฆูุงู":200,"10- ูููู ุนุณู ุฃุนุดุงุจ ุฌุจููู ูุฏููู ูุฑุณู ุนูู": 300,
            "11- ูููู ุนุณู ุณุฏุฑ ุต ุณุฏุฑ": 300,"12- ูููู ุนุณู ุฒููุฑ ุงูุฃุนุดุงุจ ุงูุทุจูู" : 250,"13- ูููู ุนุณู ุฃุนุดุงุจ ุฌุจููู ุณุงูุช ูุงุชุฑูู" : 400,
            "1- ูุตู ูููู ุนุณู ููุงุฑู ุงูุจุฑุณูู  ุตุงูู ": 90,"2- ูุตู ูููู ุนุณู  ุจุฑุณูู ุจูุฏู": 70,"3-ูุตู ุนุณู ุจุฑุณูู ุตุญุฑุงูู ":115 ,
            "4-ูุตู ุนุณู ุฒููุฑ ุงูููุงูุญ":115  ,"5-ูุตู ุนุณู ุฒููุฑ ุงูุดูุฑ ุงูุฌุจูู":125,"6-ูุตู ุนุณู  ุงูุงุซู ": 125 ,"7-ูุตู ุนุณู ุฒููุฑ ุญุจู ุงูุจุฑูู": 110,
            "8-ูุตู ุนุณู ุฒููุฑ ุงูุฒุนุชุฑ ุงูุทุจูู ุงูุฌุจูู ุงูุงูุฑุฌุงูู":125  ,"9-ูุตู ุนุณู ุฒููุฑ ุงูุจุฑุฏููุด ุงูุทุจูุนู ุตุงูู ููุงุฆูุงู":100 ,
            "10-ูุตู ุนุณู ุฃุนุดุงุจ ุฌุจููู ูุฏููู ูุฑุณู ุนูู":150  ,"11-ูุตู ุนุณู ุณุฏุฑ ุตุญุฑุงูู": 150 ,"12-ูุตู ุนุณู ุฒููุฑ ุงูุฃุนุดุงุจ ุงูุทุจูู": 125 ,
            "13- ูุตู ุนุณู ุฃุนุดุงุจ ุฌุจููู ุณุงูุช ูุงุชุฑูู":200,
            "1- ูููู ุณุฏุฑ ุฌุจูู ูุตููุฉ ุงูุญุถุฑูู ุงููููู":700 ,"2- ูููู ุณุฏุฑ ุฌุจูู ูุตููู ุงูุญุถุฑูู":550 ,"3- ูููู ุณุฏุฑ ุฌุจูู ูุดููุฑู ูููู":1800 ,
            "4- ูููู ุณุฏุฑ ุฌุจูู ูููู ุนุตููู ูููู ":2800 ,"5- ูููู ุณุฏุฑ ุฌุจูู ูุตููุฉ ุงูุฏูุนูู ุงููููู":1200 ,
            "6- ูููู ุณุฏุฑ ุงูุนุงููู ุงูุฌุจูู ุงููุงุฏุฑ ุงูุตุงูู ":500 ,"7- ูููู ุณุฏุฑ ุงูุณูุฑู ุงููููู ุงููููู":1300 ,"8- ูููู ุฏูุนูู ูููู":2800 ,
            "1-ูุตู ุณุฏุฑ ุฌุจูู ูุตููุฉ ุงูุญุถุฑูู ุงููููู":400 ,"2-ูุตู ุณุฏุฑ ุฌุจูู ูุตููู ุงูุญุถุฑูู":300 ,"3-ูุตู ุณุฏุฑ ุฌุจูู ูุดููุฑู ูููู": 950,
            "4-ูุตู ุณุฏุฑ ุฌุจูู ูููู ุนุตููู ูููู ":1450 ,"5-ูุตู ุณุฏุฑ ุฌุจูู ูุตููุฉ ุงูุฏูุนูู ุงููููู":650 ,"6-ูุตู ุนุณู ุงูุนุงููู ุงูุฌุจูู ุงููุงุฏุฑ ุงูุตุงูู ":300 ,"7-ูุตู ุนุณู ุงูุณูุฑู ุงููููู ุงููููู":700 ,"8- ูุตู ูููู ุฏูุนูู ูููู":1450 ,"1- ูุชุฑ ุฒูุช ุฒูุชูู ุงูุณุชุฑุง ููุฑุฌู ": 600 ,
            "1- ูุตู ูุชุฑ ุฒูุช ุฒูุชูู ุงูุณุชุฑุง ููุฑุฌู ":310 ,"2- ุฒูุช ุฌูุฒ ุงูููุฏ ุงูุนุถูู ุงูุบุฐุงุฆู ุจุฑุทูุงู ุญูุงูู 300 ุฌุฑุงู" :175 ,
            "3- ุฒูุช ุฌูุฒ ุงูููุฏ ุงูุนุถูู ุงูุบุฐุงุฆู ุจุฑุทูุงู  140 " :140 ,
            "1- ูุชุฑ ุฎู ุนูุจ ุงุญูุฑ ุจูุณูู ุงูุฑุฌุงูู ุนุถูู ุบูุฑ ูุจุณุชุฑ": 360,
            "2- ูุชุฑ ุฎู ุงูุชูุงุญ   ุงูุนุถูู ุบูุฑ ุงููุจุณุชุฑ" : 260,"3- ูุชุฑ ุฎู ุฑูุงู   " : 350,"3- ูุตู ูุชุฑ ุฎู ุฑูุงู   " : 185,
            "1- ูุตู ูุชุฑ ุฎู ุนูุจ ุงุญูุฑ ุจูุณูู ุงูุฑุฌุงูู ุนุถูู ุบูุฑ ูุจุณุชุฑ": 190,"2- ูุตู ูุชุฑ ุฎู ุงูุชูุงุญ ุงูุนุถูู   ุบูุฑ ุงููุจุณุชุฑ" : 140,
            "1-ูููู ุฎูุทุฉ ูุฑูููุฒ ุฎูุทุฉ ุงูุจุดูุงุช ุฑูู1 ":2200,"1-ูุตู ูููู ุฎูุทุฉ ูุฑูููุฒ ุฎูุทุฉ ุงูุจุดูุงุช ุฑูู1 ":1150,
            "2-ูููู ุฎูุทุฉ ูููู ูุฑูููุฒ ุฎูุทุฉ ุงูุจุดูุงุช ุฑูู2 ":1400,"2-ูุตู ูููู ุฎูุทุฉ ูููู ูุฑูููุฒ ุฎูุทุฉ ุงูุจุดูุงุช ุฑูู2 ":750,
            "3-ูููู ุฎูุทุฉ ูุชุฒูุฌูู ูุฑูุฒุฉ ุฎูุทู ุงูุจุงูุฑ ูุงูููุงุนู ุณุฏุฑ ุญุถุฑูู ุฑูู3":1000,
            "3-ูุตู ูููู ุฎูุทุฉ ูุชุฒูุฌูู ูุฑูุฒุฉ ุฎูุทู ุงูุจุงูุฑ ูุงูููุงุนู ุณุฏุฑ ุญุถุฑูู ุฑูู3":550,
            "4-ูููู ุฎูุทุฉ ุงูููุธููู ูุงููุงุฏุญูู  ุณุฏุฑ ุญุถุฑูู ุฑูู 4":750,"4-ูุตู ูููู ุฎูุทุฉ ุงูููุธููู ูุงููุงุฏุญูู  ุณุฏุฑ ุญุถุฑูู ุฑูู 4":400,
            "5-ูููู ุฎูุทุฉ ูุชุฒูุฌูู ุนุงุฏู ุนุณู ุจุฑุณูู ุฑูู5": 500,
            "5-ูุตู ูููู ุฎูุทุฉ ูุชุฒูุฌูู ุนุงุฏู ุนุณู ุจุฑุณูู ุฑูู5": 250,
            "6-ูููู ุฎูุทุฉ ูุชุฒูุฌูู ูุฑูุฒุฉ ุนุณู ุจุฑุณูู ุฑูู6": 550,
            "6-ูุตู ูููู ุฎูุทุฉ ูุชุฒูุฌูู ูุฑูุฒุฉ ุนุณู ุจุฑุณูู ุฑูู6": 275,
            "7-ูููู ุฎูุทุฉ ูุชุฒูุฌูู ูุฑูุฒุฉุฌุฏุง ุนุณู ุจุฑุณูู ุฑูู7": 600,
            "7-ูุตู ูููู ุฎูุทุฉ ูุชุฒูุฌูู ูุฑูุฒุฉุฌุฏุง ุนุณู ุจุฑุณูู ุฑูู7": 300,
            "8-ูููู ุฎูุทุฉ ููุงุนุฉ ุงูุงุทูุงู ุญุถุฑูู ูููู ุฑูู8":1000,
            "8-ูุตู ูููู ุฎูุทุฉ ููุงุนุฉ ุงูุงุทูุงู ุญุถุฑูู ูููู ุฑูู8":550,
            "9-ูููู ุฎูุทุฉ ููุงุนุฉ ุงูุงุทูุงู ุจุฑุณูู ุตุงูู ุนุงุฏู ุฑูู9":400,
            "9-ูุตู ูููู ุฎูุทุฉ ููุงุนุฉ ุงูุงุทูุงู ุจุฑุณูู ุตุงูู ุนุงุฏู ุฑูู9":200,
            "10-ูููู ุฎูุทุฉ ููุงุนุฉ ุงูุงุทูุงู ุจุฑุณูู ุตุงูู ูุฑูุฒุฉ ุฑูู10":500,
            "10-ูุตู ูููู ุฎูุทุฉ ููุงุนุฉ ุงูุงุทูุงู ุจุฑุณูู ุตุงูู ูุฑูุฒุฉ ุฑูู10":250,
            "11-ูููู ุฎูุทุฉ ููุงุนุฉ ุงูุงุทูุงู ุจุฑุณูู ุตุงูู ูุฑูุฒุฉ ุฌุฏุง ุฑูู11":600,
            "11-ูุตู ูููู ุฎูุทุฉ ููุงุนุฉ ุงูุงุทูุงู ุจุฑุณูู ุตุงูู ูุฑูุฒุฉ ุฌุฏุง ุฑูู11":300,
            "1- ูููู ุนุฑุถ ุนุณู ุจุฑุณูู ุตุญุฑุงูู ": 210,
            "1- ูููู ุนุฑุถ ุนุณู ุงูุดูุฑ ุงูุฌุจูู ":227.5,"3-  ูููู ุนุฑุถ ุนุณู ุงุนุดุงุจ ุทุจูุฉ":230,"ูููู ุนุฑุถ ุฏูุนูู ูููู ":1050,
            "ูููู ุนุฑุถ ุฏูุนูู ูููู ูุฏุนู ":1000,"ูููู ุดูุน ุดูุฑ ": 300,"ูุตู ูููู ุดูุน ููุงูุญ": 150,
            "1- ุฌุฑุงู ุญุจูุจ ููุงุญ ": 1,"2- ุฌุฑุงู ุจุฑูุจููุฒ ": 7,"3- ุฌุฑุงู ุบุฐุงุก ูููุงุช":20,"3- ุฌุฑุงู ุทูุน ูุฎู":1,"    ":0
        };
        const categories = {
            "1":["1- ูููู ุนุณู ููุงุฑู ุงูุจุฑุณูู  ุตุงูู ","2- ูููู ุนุณู  ุจุฑุณูู ุจูุฏู   ","3- ูููู ุนุณู ุจุฑุณูู ุตุญุฑุงูู ","4- ูููู ุนุณู ุฒููุฑ ุงูููุงูุญ","5- ูููู ุนุณู ุฒููุฑ ุงูุดูุฑ ุงูุฌุจูู","6- ูููู ุนุณู ุงูุงุซู  ","7- ูููู ุนุณู ุฒููุฑ ุญุจู ุงูุจุฑูู","8- ูููู ุนุณู ุฒููุฑ ุงูุฒุนุชุฑ ุงูุทุจูู ุงูุฌุจูู ุงูุงูุฑุฌุงูู","9- ูููู ุนุณู ุฒููุฑ ุงูุจุฑุฏููุด ุงูุทุจูุนู ุตุงูู ููุงุฆูุงู","10- ูููู ุนุณู ุฃุนุดุงุจ ุฌุจููู ูุฏููู ูุฑุณู ุนูู","11- ูููู ุนุณู ุณุฏุฑ ุต ุณุฏุฑ","12- ูููู ุนุณู ุฒููุฑ ุงูุฃุนุดุงุจ ุงูุทุจูู","13- ูููู ุนุณู ุฃุนุดุงุจ ุฌุจููู ุณุงูุช ูุงุชุฑูู"],
            "2":["1- ูุตู ูููู ุนุณู ููุงุฑู ุงูุจุฑุณูู  ุตุงูู ","2- ูุตู ูููู ุนุณู  ุจุฑุณูู ุจูุฏู","3-ูุตู ุนุณู ุจุฑุณูู ุตุญุฑุงูู ","4-ูุตู ุนุณู ุฒููุฑ ุงูููุงูุญ","5-ูุตู ุนุณู ุฒููุฑ ุงูุดูุฑ ุงูุฌุจูู","6-ูุตู ุนุณู  ุงูุงุซู ","7-ูุตู ุนุณู ุฒููุฑ ุญุจู ุงูุจุฑูู","8-ูุตู ุนุณู ุฒููุฑ ุงูุฒุนุชุฑ ุงูุทุจูู ุงูุฌุจูู ุงูุงูุฑุฌุงูู","9-ูุตู ุนุณู ุฒููุฑ ุงูุจุฑุฏููุด ุงูุทุจูุนู ุตุงูู ููุงุฆูุงู","10-ูุตู ุนุณู ุฃุนุดุงุจ ุฌุจููู ูุฏููู ูุฑุณู ุนูู","11-ูุตู ุนุณู ุณุฏุฑ ุตุญุฑุงูู","12-ูุตู ุนุณู ุฒููุฑ ุงูุฃุนุดุงุจ ุงูุทุจูู","13- ูุตู ุนุณู ุฃุนุดุงุจ ุฌุจููู ุณุงูุช ูุงุชุฑูู"],
            "3":["1- ูููู ุณุฏุฑ ุฌุจูู ูุตููุฉ ุงูุญุถุฑูู ุงููููู","2- ูููู ุณุฏุฑ ุฌุจูู ูุตููู ุงูุญุถุฑูู","3- ูููู ุณุฏุฑ ุฌุจูู ูุดููุฑู ูููู","4- ูููู ุณุฏุฑ ุฌุจูู ูููู ุนุตููู ูููู ","5- ูููู ุณุฏุฑ ุฌุจูู ูุตููุฉ ุงูุฏูุนูู ุงููููู","6- ูููู ุณุฏุฑ ุงูุนุงููู ุงูุฌุจูู ุงููุงุฏุฑ ุงูุตุงูู ","7- ูููู ุณุฏุฑ ุงูุณูุฑู ุงููููู ุงููููู","8- ูููู ุฏูุนูู ูููู"],
            "4":["1-ูุตู ุณุฏุฑ ุฌุจูู ูุตููุฉ ุงูุญุถุฑูู ุงููููู","2-ูุตู ุณุฏุฑ ุฌุจูู ูุตููู ุงูุญุถุฑูู","3-ูุตู ุณุฏุฑ ุฌุจูู ูุดููุฑู ูููู","4-ูุตู ุณุฏุฑ ุฌุจูู ูููู ุนุตููู ูููู ","5-ูุตู ุณุฏุฑ ุฌุจูู ูุตููุฉ ุงูุฏูุนูู ุงููููู","6-ูุตู ุนุณู ุงูุนุงููู ุงูุฌุจูู ุงููุงุฏุฑ ุงูุตุงูู ","7-ูุตู ุนุณู ุงูุณูุฑู ุงููููู ุงููููู","8- ูุตู ูููู ุฏูุนูู ูููู"],
            "5":["1- ูุชุฑ ุฒูุช ุฒูุชูู ุงูุณุชุฑุง ููุฑุฌู "],
            "6":["1- ูุตู ูุชุฑ ุฒูุช ุฒูุชูู ุงูุณุชุฑุง ููุฑุฌู ","2- ุฒูุช ุฌูุฒ ุงูููุฏ ุงูุนุถูู ุงูุบุฐุงุฆู ุจุฑุทูุงู ุญูุงูู 300 ุฌุฑุงู","3- ุฒูุช ุฌูุฒ ุงูููุฏ ุงูุนุถูู ุงูุบุฐุงุฆู ุจุฑุทูุงู  140 "],
            "7":["1- ูุชุฑ ุฎู ุนูุจ ุงุญูุฑ ุจูุณูู ุงูุฑุฌุงูู ุนุถูู ุบูุฑ ูุจุณุชุฑ","2- ูุชุฑ ุฎู ุงูุชูุงุญ   ุงูุนุถูู ุบูุฑ ุงููุจุณุชุฑ","3- ูุชุฑ ุฎู ุฑูุงู   ","3- ูุตู ูุชุฑ ุฎู ุฑูุงู   "],
            "8":["1- ูุตู ูุชุฑ ุฎู ุนูุจ ุงุญูุฑ ุจูุณูู ุงูุฑุฌุงูู ุนุถูู ุบูุฑ ูุจุณุชุฑ","2- ูุตู ูุชุฑ ุฎู ุงูุชูุงุญ ุงูุนุถูู   ุบูุฑ ุงููุจุณุชุฑ"],
            "9":["1-ูููู ุฎูุทุฉ ูุฑูููุฒ ุฎูุทุฉ ุงูุจุดูุงุช ุฑูู1 ","1-ูุตู ูููู ุฎูุทุฉ ูุฑูููุฒ ุฎูุทุฉ ุงูุจุดูุงุช ุฑูู1 ","2-ูููู ุฎูุทุฉ ูููู ูุฑูููุฒ ุฎูุทุฉ ุงูุจุดูุงุช ุฑูู2 ","2-ูุตู ูููู ุฎูุทุฉ ูููู ูุฑูููุฒ ุฎูุทุฉ ุงูุจุดูุงุช ุฑูู2 ","3-ูููู ุฎูุทุฉ ูุชุฒูุฌูู ูุฑูุฒุฉ ุฎูุทู ุงูุจุงูุฑ ูุงูููุงุนู ุณุฏุฑ ุญุถุฑูู ุฑูู3","3-ูุตู ูููู ุฎูุทุฉ ูุชุฒูุฌูู ูุฑูุฒุฉ ุฎูุทู ุงูุจุงูุฑ ูุงูููุงุนู ุณุฏุฑ ุญุถุฑูู ุฑูู3","4-ูููู ุฎูุทุฉ ุงูููุธููู ูุงููุงุฏุญูู  ุณุฏุฑ ุญุถุฑูู ุฑูู 4","4-ูุตู ูููู ุฎูุทุฉ ุงูููุธููู ูุงููุงุฏุญูู  ุณุฏุฑ ุญุถุฑูู ุฑูู 4","5-ูููู ุฎูุทุฉ ูุชุฒูุฌูู ุนุงุฏู ุนุณู ุจุฑุณูู ุฑูู5","5-ูุตู ูููู ุฎูุทุฉ ูุชุฒูุฌูู ุนุงุฏู ุนุณู ุจุฑุณูู ุฑูู5","6-ูููู ุฎูุทุฉ ูุชุฒูุฌูู ูุฑูุฒุฉ ุนุณู ุจุฑุณูู ุฑูู6","6-ูุตู ูููู ุฎูุทุฉ ูุชุฒูุฌูู ูุฑูุฒุฉ ุนุณู ุจุฑุณูู ุฑูู6","7-ูููู ุฎูุทุฉ ูุชุฒูุฌูู ูุฑูุฒุฉุฌุฏุง ุนุณู ุจุฑุณูู ุฑูู7","7-ูุตู ูููู ุฎูุทุฉ ูุชุฒูุฌูู ูุฑูุฒุฉุฌุฏุง ุนุณู ุจุฑุณูู ุฑูู7","8-ูููู ุฎูุทุฉ ููุงุนุฉ ุงูุงุทูุงู ุญุถุฑูู ูููู ุฑูู8","8-ูุตู ูููู ุฎูุทุฉ ููุงุนุฉ ุงูุงุทูุงู ุญุถุฑูู ูููู ุฑูู8","9-ูููู ุฎูุทุฉ ููุงุนุฉ ุงูุงุทูุงู ุจุฑุณูู ุตุงูู ุนุงุฏู ุฑูู9","9-ูุตู ูููู ุฎูุทุฉ ููุงุนุฉ ุงูุงุทูุงู ุจุฑุณูู ุตุงูู ุนุงุฏู ุฑูู9","10-ูููู ุฎูุทุฉ ููุงุนุฉ ุงูุงุทูุงู ุจุฑุณูู ุตุงูู ูุฑูุฒุฉ ุฑูู10","10-ูุตู ูููู ุฎูุทุฉ ููุงุนุฉ ุงูุงุทูุงู ุจุฑุณูู ุตุงูู ูุฑูุฒุฉ ุฑูู10","11-ูููู ุฎูุทุฉ ููุงุนุฉ ุงูุงุทูุงู ุจุฑุณูู ุตุงูู ูุฑูุฒุฉ ุฌุฏุง ุฑูู11","11-ูุตู ูููู ุฎูุทุฉ ููุงุนุฉ ุงูุงุทูุงู ุจุฑุณูู ุตุงูู ูุฑูุฒุฉ ุฌุฏุง ุฑูู11"],
            "10":["1- ูููู ุนุฑุถ ุนุณู ุจุฑุณูู ุตุญุฑุงูู ","1- ูููู ุนุฑุถ ุนุณู ุงูุดูุฑ ุงูุฌุจูู ","3-  ูููู ุนุฑุถ ุนุณู ุงุนุดุงุจ ุทุจูุฉ","ูููู ุนุฑุถ ุฏูุนูู ูููู ","ูููู ุนุฑุถ ุฏูุนูู ูููู ูุฏุนู "],
            "11":["ูููู ุดูุน ุดูุฑ ","ูุตู ูููู ุดูุน ููุงูุญ","1- ุฌุฑุงู ุญุจูุจ ููุงุญ ","2- ุฌุฑุงู ุจุฑูุจููุฒ ","3- ุฌุฑุงู ุบุฐุงุก ูููุงุช","3- ุฌุฑุงู ุทูุน ูุฎู","    "]
        };
        const shippingCosts = {
            "ุฌููุน ุงููุญุงูุธุงุช": 90,"ุงูุตุนูุฏ ูุงูุจุญุฑ ุงูุงุญูุฑ ูุงูุบุฑุฏูุฉ": 120,"ุณููุงุฌ ุงูุดุญู 25 ุงู 30": 30,"ุดุญู ูุฌุงูู": 0
        };

        // ูู ุฏูุงู ุงูุฌุงูุงุณูุฑูุจุช ููุง...
        // ุชู ูุฑุงุฌุนุชูุง ุจุงููุงูู ูุชููู ูุชูุงููุฉ ูุน ุงูุชุตููู ุงูุฌุฏูุฏ
        function updateCalculatorCounter() {
            const count = document.querySelectorAll('.calculator-container').length;
            const counterDesktop = document.getElementById('calculator-counter');
            if (counterDesktop) counterDesktop.textContent = `ุงูุนุฏุฏ: ${count}`;
        }

        function createCalculator(id) {
            const calculator = document.createElement('div');
            calculator.className = 'calculator-container';
            calculator.id = `calculator-${id}`;
            const now = new Date();
            const dateString = now.toLocaleDateString('ar-EG', { year: 'numeric', month: 'long', day: 'numeric' });
            calculator.innerHTML = `
                <div class="calculator-header">
                     <div class="calculator-title-display">
                        <span class="calculator-title">ุขูุฉ ุญุงุณุจุฉ ${id + 1}</span>
                        <button class="edit-title-btn" onclick="enableTitleEdit(this, '${id}')">โ๏ธ</button>
                    </div>
                     <button onclick="removeCalculator('${id}')" style="background-color:var(--accent-red); font-size: 0.9rem; padding: 5px 10px;">ุญุฐู</button>
                </div>
                <input type="text" class="calculator-title-input" placeholder="ุฃุฏุฎู ุงุณูุงู ููุขูุฉ ุงูุญุงุณุจุฉ..." style="display: none;" onchange="updateCalculatorTitle(this, '${id}')" onblur="updateCalculatorTitle(this, '${id}')">
                <div class="calculator-date">ุชุงุฑูุฎ ุงูุฅูุดุงุก: ${dateString}</div>
                <div id="items-container-${id}" style="margin-top: 20px;"></div>
                <button onclick="addItem('${id}')" style="background-color: var(--primary-color); margin-top:15px; width: 100%;">+ ุฅุถุงูุฉ ุตูู</button>
                <div class="totals-section">
                    <div class="total"><span>ุงูุฅุฌูุงูู:</span><span class="price" id="total-${id}">0 ุฌููู</span></div>
                    <div class="shipping"><label for="governorate-${id}" style="flex-shrink:0; margin-left:10px;">ููุทูุฉ ุงูุดุญู:</label><select id="governorate-${id}" onchange="updateShipping('${id}')"><option value="">ุงุฎุชุฑ</option><option value="ุฌููุน ุงููุญุงูุธุงุช">ุฌููุน ุงููุญุงูุธุงุช</option><option value="ุงูุตุนูุฏ ูุงูุจุญุฑ ุงูุงุญูุฑ ูุงูุบุฑุฏูุฉ">ุตุนูุฏ/ุจุญุฑ ุฃุญูุฑ</option><option value="ุณููุงุฌ ุงูุดุญู 25 ุงู 30">ุณููุงุฌ</option><option value="ุดุญู ูุฌุงูู">ุดุญู ูุฌุงูู</option></select></div>
                    <div class="shipping"><span>ุณุนุฑ ุงูุดุญู:</span><span class="shipping-cost" id="shipping-cost-${id}">0 ุฌููู</span></div>
                    <div class="grand-total"><span>ุงูุฅุฌูุงูู ุงูููู:</span><span class="grand-total-value" id="grand-total-${id}">0 ุฌููู</span></div>
                </div>
                <button onclick="showCalculatedResults('${id}')" style="background-color:var(--accent-green); margin-top: 20px; width: 100%; padding: 12px; font-size: 1.1rem;">๐งพ ุนุฑุถ ุงููุงุชูุฑุฉ</button>
                <div id="results-container-${id}" style="display:none;"></div>`;
            return calculator;
        }

        function addItem(calculatorId) {
            const itemsContainer = document.getElementById(`items-container-${calculatorId}`);
            const newItem = document.createElement('div');
            newItem.className = 'item';
            newItem.innerHTML = `
                <select onchange="updateItems(this, '${calculatorId}')"><option value="">ุงุฎุชุฑ ุงููุฆุฉ</option><option value="1">ูููู ุนุณู</option><option value="2">ูุตู ูููู ุนุณู</option><option value="3">ูููู ุนุณู ุณุฏุฑ</option><option value="4">ูุตู ุนุณู ุณุฏุฑ</option><option value="5">ูุชุฑ ุฒูุช</option><option value="6">ูุตู ูุชุฑ ุฒูุช</option><option value="7">ูุชุฑ ุฎู</option><option value="8">ูุตู ูุชุฑ ุฎู</option><option value="9">ุฎูุทุงุช</option><option value="10">ุนุฑูุถ</option><option value="11">ุงุฎุฑู</option></select>
                <select onchange="updatePrice(this, '${calculatorId}')"><option value="">ุงุฎุชุฑ ุงูุตูู</option></select>
                <div class="item-controls"><input type="number" value="1" min="1" onchange="updatePrice(this, '${calculatorId}')"><strong class="price">0 ุฌููู</strong><button onclick="removeItem(this, '${calculatorId}')">ุฅุฒุงูุฉ</button></div>`;
            itemsContainer.appendChild(newItem);
            const categorySelect = newItem.querySelector('select:nth-of-type(1)');
            categorySelect.value = '1';
            updateItems(categorySelect, calculatorId);
            saveCalculatorsState();
        }

        function updateItems(selectElement, calculatorId) {
            const itemDiv = selectElement.closest('.item');
            const itemSelect = itemDiv.querySelector('select:nth-of-type(2)');
            const category = selectElement.value;
            itemSelect.innerHTML = '<option value="">ุงุฎุชุฑ ุงูุตูู</option>';
            if (category && categories[category]) {
                categories[category].forEach(item => {
                    const option = document.createElement('option');
                    option.value = item;
                    option.textContent = item;
                    itemSelect.appendChild(option);
                });
            }
            updatePrice(itemSelect, calculatorId);
        }

        function updatePrice(element, calculatorId) {
            const itemDiv = element.closest('.item');
            const itemSelect = itemDiv.querySelector('select:nth-of-type(2)');
            const quantityInput = itemDiv.querySelector('input[type="number"]');
            const priceSpan = itemDiv.querySelector('.price');
            const item = itemSelect.value;
            const quantity = parseInt(quantityInput.value) || 0;
            priceSpan.textContent = (item && quantity > 0 ? prices[item] * quantity : 0) + ' ุฌููู';
            updateTotal(calculatorId);
        }
        
        function removeItem(button, calculatorId) {
            button.closest('.item').remove();
            updateTotal(calculatorId);
        }
        
        function updateTotal(calculatorId) {
            let total = 0;
            document.querySelectorAll(`#items-container-${calculatorId} .price`).forEach(span => {
                total += parseFloat(span.textContent) || 0;
            });
            document.getElementById(`total-${calculatorId}`).textContent = total + ' ุฌููู';
            updateGrandTotal(calculatorId);
        }

        function updateShipping(calculatorId) {
            const governorate = document.getElementById(`governorate-${calculatorId}`).value;
            const shippingCost = governorate ? shippingCosts[governorate] : 0;
            document.getElementById(`shipping-cost-${calculatorId}`).textContent = shippingCost + ' ุฌููู';
            updateGrandTotal(calculatorId);
        }

        function updateGrandTotal(calculatorId) {
            const total = parseFloat(document.getElementById(`total-${calculatorId}`).textContent) || 0;
            const shippingCost = parseFloat(document.getElementById(`shipping-cost-${calculatorId}`).textContent) || 0;
            document.getElementById(`grand-total-${calculatorId}`).textContent = (total + shippingCost) + ' ุฌููู';
            saveCalculatorsState();
        }

        function toArabicNumerals(str) {
            return String(str).replace(/[0-9]/g, d => ({'0':'ู','1':'ูก','2':'ูข','3':'ูฃ','4':'ูค','5':'ูฅ','6':'ูฆ','7':'ูง','8':'ูจ','9':'ูฉ'}[d]));
        }

        function searchCalculators(searchTerm) {
            const term = searchTerm.toLowerCase();
            document.querySelectorAll('.calculator-container').forEach(calc => {
                const title = calc.querySelector('.calculator-title').textContent.toLowerCase();
                calc.style.display = title.includes(term) ? 'block' : 'none';
            });
        }
        
        function showCalculatedResults(calculatorId) {
            const resultsContainer = document.getElementById(`results-container-${calculatorId}`);
            if (resultsContainer.style.display === 'block') { resultsContainer.style.display = 'none'; return; }
            resultsContainer.innerHTML = ''; 
            const items = document.querySelectorAll(`#items-container-${calculatorId} .item`);
            if (items.length === 0) { alert('ูุง ุชูุฌุฏ ุนูุงุตุฑ.'); return; }
            let resultsText = "*ุชูุงุตูู ุงูุทูุจ:*\n" + "ุงูุตูู\t=\tุงูุณุนุฑ\n" + "______________________________\n";
            let summaryList = [], itemLines = [], totalQuantity = 0;
            items.forEach((item, index) => {
                const itemName = item.querySelector('select:nth-of-type(2)').value;
                const quantity = parseInt(item.querySelector('input[type="number"]').value);
                const price = parseFloat(item.querySelector('.price').textContent);
                if (itemName && quantity > 0 && price >= 0) {
                    const cleanedItemName = itemName.replace(/^\d+\-\s*/g, '').trim();
                    totalQuantity += quantity;
                    itemLines.push(`${index + 1}- ${quantity > 1 ? `ุนุฏุฏ ${toArabicNumerals(quantity)} ` : ''}${cleanedItemName}\t=\t${toArabicNumerals(price)}`);
                    summaryList.push(`-${index + 1}-(${quantity > 1 ? `ุนุฏุฏ ${quantity} ` : ''}${cleanedItemName})`);
                }
            });
            if (itemLines.length === 0) { alert('ูู ูุชู ุชุญุฏูุฏ ุฃุตูุงู ุตุงูุญุฉ.'); return; }
            resultsText += itemLines.join('\n') + `\n______________________________\n*ุนุฏุฏ ุงููุทุน*=\t${toArabicNumerals(totalQuantity)}\n______________________________\n`;
            const total = parseFloat(document.getElementById(`total-${calculatorId}`).textContent);
            const shippingSelect = document.getElementById(`governorate-${calculatorId}`);
            const shippingText = shippingSelect.options[shippingSelect.selectedIndex].text;
            const shippingCost = parseFloat(document.getElementById(`shipping-cost-${calculatorId}`).textContent);
            const grandTotal = parseFloat(document.getElementById(`grand-total-${calculatorId}`).textContent);
            resultsText += `*ุงููุฌููุน*=\t${toArabicNumerals(total)}\n`;
            if (shippingSelect.value && shippingCost > 0) resultsText += `*ุชูููุฉ ุงูุดุญู (${shippingText})* =\t${toArabicNumerals(shippingCost)}\n`;
            resultsText += `______________________________\n*ุงููุฌููุน ุงูููู*=\t${toArabicNumerals(grandTotal)}\n______________________________\n`;
            resultsText += `*ููุงุญู ุงูุตุนูุฏู ู*:${summaryList.join(' ')}`;
            const textNode = document.createElement('div');
            textNode.className = 'results-text-container';
            textNode.textContent = resultsText;
            const actionsDiv = document.createElement('div');
            actionsDiv.className = 'copy-actions';
            const copyBtn = document.createElement('button');
            copyBtn.textContent = '๐ ูุณุฎ ุงููุต ูุจุงุดุฑุฉ'; copyBtn.style.backgroundColor = 'var(--primary-color)';
            const selectBtn = document.createElement('button');
            selectBtn.textContent = 'โ๏ธ ุชุญุฏูุฏ ุงููุต ูููุณุฎ'; selectBtn.style.backgroundColor = 'var(--accent-green)';
            const instructionP = document.createElement('p');
            instructionP.className = 'copy-instruction'; instructionP.textContent = 'ุฌุฑูุจ "ูุณุฎ ูุจุงุดุฑ". ุฅุฐุง ูู ูุนููุ ุงุณุชุฎุฏู ุฒุฑ "ุชุญุฏูุฏ ุงููุต".';
            copyBtn.onclick = () => {
                const textarea = document.createElement('textarea');
                textarea.value = resultsText;
                textarea.style.position = 'fixed'; textarea.style.left = '-9999px';
                document.body.appendChild(textarea);
                textarea.select();
                try {
                    if (document.execCommand('copy')) {
                        copyBtn.textContent = 'โ ุชู ุงููุณุฎ!'; instructionP.textContent = 'ุชู ุงููุณุฎ ุฅูู ุงูุญุงูุธุฉ.';
                    } else { throw new Error(); }
                } catch (err) {
                    copyBtn.textContent = 'โ ูุดู ุงููุณุฎ'; instructionP.textContent = 'ูุดู ุงููุณุฎ ุงููุจุงุดุฑ. ุงุณุชุฎุฏู ุฒุฑ ุงูุชุญุฏูุฏ.';
                }
                document.body.removeChild(textarea);
                setTimeout(() => { copyBtn.textContent = '๐ ูุณุฎ ุงููุต ูุจุงุดุฑุฉ'; }, 3000);
            };
            selectBtn.onclick = () => {
                const range = document.createRange();
                range.selectNodeContents(textNode);
                window.getSelection().removeAllRanges();
                window.getSelection().addRange(range);
                selectBtn.textContent = 'โ ุชู ุงูุชุญุฏูุฏ!';
                instructionP.textContent = 'ุงููุต ูุญุฏุฏ ุงูุขู. ุงุณุชุฎุฏู ุฎูุงุฑ ุงููุณุฎ ูู ูุงุชูู.';
                setTimeout(() => { selectBtn.textContent = 'โ๏ธ ุชุญุฏูุฏ ุงููุต ูููุณุฎ'; }, 3000);
            };
            actionsDiv.appendChild(copyBtn);
            actionsDiv.appendChild(selectBtn);
            resultsContainer.appendChild(textNode);
            resultsContainer.appendChild(actionsDiv);
            resultsContainer.appendChild(instructionP);
            resultsContainer.style.display = 'block';
        }

        function getCalculatorsData() {
            const data = [];
            document.querySelectorAll('.calculator-container').forEach(calc => {
                const id = calc.id.split('-')[1];
                data.push({
                    id: id, title: calc.querySelector('.calculator-title').textContent, date: calc.querySelector('.calculator-date').textContent,
                    governorate: document.getElementById(`governorate-${id}`).value,
                    items: Array.from(document.querySelectorAll(`#items-container-${id} .item`)).map(item => ({
                        category: item.querySelector('select:nth-of-type(1)').value, item: item.querySelector('select:nth-of-type(2)').value, quantity: item.querySelector('input[type="number"]').value
                    }))
                });
            });
            return data;
        }

        function saveCalculatorsState() { localStorage.setItem('honeyCalculators', JSON.stringify(getCalculatorsData())); }

        function loadCalculatorsFromData(calculatorsData) {
            const container = document.getElementById('calculators-container');
            container.innerHTML = '';
            if (calculatorsData) {
                calculatorsData.forEach(data => {
                    const calculator = createCalculator(data.id);
                    container.appendChild(calculator);
                    calculator.querySelector('.calculator-title').textContent = data.title;
                    calculator.querySelector('.calculator-date').textContent = data.date;
                    const itemsContainer = document.getElementById(`items-container-${data.id}`);
                    itemsContainer.innerHTML = ''; 
                    (data.items || []).forEach(itemData => {
                        const newItem = document.createElement('div');
                        newItem.className = 'item';
                        newItem.innerHTML = `
                            <select onchange="updateItems(this, '${data.id}')"><option value="">ุงุฎุชุฑ ุงููุฆุฉ</option><option value="1">ูููู ุนุณู</option><option value="2">ูุตู ูููู ุนุณู</option><option value="3">ูููู ุนุณู ุณุฏุฑ</option><option value="4">ูุตู ุนุณู ุณุฏุฑ</option><option value="5">ูุชุฑ ุฒูุช</option><option value="6">ูุตู ูุชุฑ ุฒูุช</option><option value="7">ูุชุฑ ุฎู</option><option value="8">ูุตู ูุชุฑ ุฎู</option><option value="9">ุฎูุทุงุช</option><option value="10">ุนุฑูุถ</option><option value="11">ุงุฎุฑู</option></select>
                            <select onchange="updatePrice(this, '${data.id}')"><option value="">ุงุฎุชุฑ ุงูุตูู</option></select>
                            <div class="item-controls"><input type="number" value="${itemData.quantity}" min="1" onchange="updatePrice(this, '${data.id}')"><strong class="price">0 ุฌููู</strong><button onclick="removeItem(this, '${data.id}')">ุฅุฒุงูุฉ</button></div>`;
                        itemsContainer.appendChild(newItem);
                        const catSelect = newItem.querySelector('select:nth-of-type(1)');
                        catSelect.value = itemData.category;
                        updateItems(catSelect, data.id);
                        newItem.querySelector('select:nth-of-type(2)').value = itemData.item;
                        updatePrice(newItem.querySelector('select:nth-of-type(2)'), data.id);
                    });
                    document.getElementById(`governorate-${data.id}`).value = data.governorate;
                    updateShipping(data.id);
                });
            }
            updateCalculatorCounter();
        }

        function exportCalculatorsAsJSON() {
            const data = getCalculatorsData();
            if (data.length === 0) { alert('ูุง ููุฌุฏ ุจูุงูุงุช ููุญูุธ.'); return; }
            const a = document.createElement('a');
            a.href = URL.createObjectURL(new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' }));
            a.download = 'calculators_backup.json';
            a.click();
            URL.revokeObjectURL(a.href);
        }

        function importCalculatorsFromJSON(event) {
            const file = event.target.files[0];
            if (!file) return;
            if (!confirm('ุณูุคุฏู ูุฐุง ูุงุณุชุจุฏุงู ูู ุงูุขูุงุช ุงูุญุงุณุจุฉ ุงูุญุงููุฉ. ูู ุฃูุช ูุชุฃูุฏุ')) { event.target.value = null; return; }
            const reader = new FileReader();
            reader.onload = e => {
                try {
                    const data = JSON.parse(e.target.result);
                    loadCalculatorsFromData(data);
                    saveCalculatorsState();
                } catch (error) { alert('ุฎุทุฃ ูู ูุฑุงุกุฉ ุงูููู.'); console.error(error); }
            };
            reader.readAsText(file);
            event.target.value = null;
        }
        
        function addNewCalculator() {
            const id = Date.now().toString();
            document.getElementById('calculators-container').prepend(createCalculator(id));
            updateCalculatorCounter();
            saveCalculatorsState();
        }

        function enableTitleEdit(button, id) {
            const header = button.closest('.calculator-header');
            const titleDisplay = header.querySelector('.calculator-title-display');
            const titleInput = header.parentElement.querySelector('.calculator-title-input');
            const currentTitle = titleDisplay.querySelector('.calculator-title').textContent;
            if (!currentTitle.startsWith("ุขูุฉ ุญุงุณุจุฉ")) titleInput.value = currentTitle;
            titleInput.style.display = 'block';
            titleDisplay.style.display = 'none';
            titleInput.focus();
        }

        function updateCalculatorTitle(input, id) {
            const header = input.parentElement.querySelector('.calculator-header');
            const titleDisplay = header.querySelector('.calculator-title-display');
            const titleSpan = titleDisplay.querySelector('.calculator-title');
            if (input.value.trim()) titleSpan.textContent = input.value.trim();
            input.style.display = 'none';
            titleDisplay.style.display = 'flex';
            saveCalculatorsState();
        }
        
        function removeCalculator(id) {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐู ุงูุขูุฉ ุงูุญุงุณุจุฉุ')) {
                document.getElementById(`calculator-${id}`).remove();
                updateCalculatorCounter();
                saveCalculatorsState();
            }
        }

        window.addEventListener('load', () => {
            try {
                const savedData = JSON.parse(localStorage.getItem('honeyCalculators'));
                if (savedData && savedData.length > 0) {
                    loadCalculatorsFromData(savedData);
                } else {
                    addNewCalculator();
                }
            } catch (e) {
                console.error("Could not load from localStorage", e);
                addNewCalculator();
            }
        });
    </script>
    
    <!-- === ููุฏ ุชุณุฌูู ููู ุงูุฎุฏูุฉ ููุนูู ุฃูููุงูู === -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js').then(registration => {
                    console.log('ServiceWorker: Registration Successful');
                }).catch(err => {
                    console.log('ServiceWorker: Registration Failed: ', err);
                });
            });
        }
    </script>
</body>
</html>